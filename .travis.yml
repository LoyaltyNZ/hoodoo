# https://bugs.ruby-lang.org/issues/11657
#
# At the time of writing both 2.1.8 and 2.3.0 now work, but 2.2.4 still crashes.
#
language: ruby
rvm:
  - 2.1.8
  - 2.3.0

# http://blog.travis-ci.com/2014-12-17-faster-builds-with-container-based-infrastructure/
#
sudo: false

# http://docs.travis-ci.com/user/caching/
#
cache: bundler

addons:
  postgresql: '9.3'

script:
  - TZ=Pacific/Auckland DATABASE_USER=postgres bundle exec rspec spec --backtrace

# https://docs.travis-ci.com/user/deployment/rubygems
# API key is encrypted and secure.
#
deploy:
  provider: rubygems
  api_key:
    secure: APN8T7ShkAfdWH+HPL7c6uSmzCbAUEy65KhXdsGKTfu8tqZFgkLUUJtc/2D5QB3tbZVHSkWXMMJkGLHy/7xpWjVKm9e0jvpp/eYJ0KK7Z3YM1lrFESfeDYZ+gdIauZr+GPrQr75IzVxJn/eXTFj62+5PjjbcKOBjqnRR7R17UDHVqtisNm5EUi+WF8cmhVCwX5HITBaNOuc2FFT6YgFPMBfjNYOgbubqjR3BGPvCOzJD1w5w3hZ2j5YL0k7jek5syRqnZfYbl6WsJS5jUXNKzB4VDKCIVw4zVhsfGRJsfbg4A/bgyXPAKHLdVdAPAtqPOqCUSLHnBfcfqYSs97gMqXvpTIEqPN2qAbKLa+Mua1Zy0GEl2Pwffa1M06wJArP+dFFpncZu+DTJdriuvdCt5sJMW0hqQTUqCMjYPwrwU5dluftQEeLY0tt14+qpH+trOWiCQqPSaPKO0tVBwmKwbM+CTGjLPr7KgkndbdSyaK39sTdWBkXWit2+b2+OnFPUJDSxI21hP5DnowAgH056VcJlGw9iqThYrvVrmgKKAauZ9NGIx6YQAPvF1quE2O5SKfT/dEDzA2mryB7N9Dwu3Q7XEEO/2+Of7WjCTQPwpnXEIO6lOFYxb2ra1LBBF8jOde5nYDeuneKZsv38euptXU0S8fFNW+/H45L/l7GuBdg=
  gem: hoodoo
  on:
    tags: true
    repo: LoyaltyNZ/hoodoo
