<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>ApiTools::Presenters::BasePresenter</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/github.css" type="text/css" media="screen" />
<script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            ApiTools::Presenters::BasePresenter 
            
                <span class="parent">&lt; 
                    
                    Object
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/lib/api_tools/presenters/base_presenter_rb.html">lib/api_tools/presenters/base_presenter.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>Base functionality for JSON validation and presenter (rendering) layers.
Subclass this to define a schema against which validation of inbound data
or rendering of outbound data can be performed. Call <a
href="BasePresenter.html#method-c-schema">::schema</a> in the subclass to
declare, via the DSL, the shape of the schema.</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>G</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-get_schema">get_schema</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-render">render</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-schema">schema</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>V</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-validate">validate</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-get_schema">
            
              <b>get_schema</b>()
            
            <a href="../../../classes/ApiTools/Presenters/BasePresenter.html#method-c-get_schema" name="method-c-get_schema" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Return the schema graph.</p>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-get_schema_source')" id="l_method-c-get_schema_source">show</a>
                
              </p>
              <div id="method-c-get_schema_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/api_tools/presenters/base_presenter.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">get_schema</span>
  <span class="ruby-ivar">@schema</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-render">
            
              <b>render</b>(data)
            
            <a href="../../../classes/ApiTools/Presenters/BasePresenter.html#method-c-render" name="method-c-render" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Given some data that should conform to the subclass presenter&#39;s schema,
render it to go from the input Ruby <a href="Hash.html">Hash</a>, to an
output Ruby <a href="Hash.html">Hash</a> which will include default values
- if any - present in the schema and will drop input fields not present in
that schema. In essence, this takes data which may have been
programatically generated and sanitises it to produce valid, with-defaults
guaranteed valid output.</p>

<p>Any field with a schema giving a default value will only appear should a
value for that field be <em>omitted</em> in the input data. If the data
provides, for example, an explicit <code>nil</code> value then a
corresponding explicit <code>nil</code> will be rendered, regardless of
defaults.</p>

<p>For belt-and-braces, unless subsequent profiling shows performance issues,
callers should call validate first to self-check their internal data
against the schema prior to rendering. That way, coding errors will be
discovered immediately, rather than hidden / obscured by the rendered
sanitisation.</p>

<p>Since rendering top-level <code>nil</code> is not valid JSON, should
<code>nil</code> be provided as input, it&#39;ll be treated as an empty
hash (“+{}+”) instead.</p>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-render_source')" id="l_method-c-render_source">show</a>
                
              </p>
              <div id="method-c-render_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/api_tools/presenters/base_presenter.rb, line 55</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">data</span>)
  <span class="ruby-identifier">target</span> = {}
  <span class="ruby-identifier">data</span>   = <span class="ruby-identifier">data</span> <span class="ruby-operator">||</span> {}
  <span class="ruby-ivar">@schema</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">target</span>)
  <span class="ruby-identifier">target</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-schema">
            
              <b>schema</b>(&amp;block)
            
            <a href="../../../classes/ApiTools/Presenters/BasePresenter.html#method-c-schema" name="method-c-schema" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Define the JSON schema for validation.</p>
<dl class="rdoc-list note-list"><dt>&amp;block
<dd>
<p>Block that makes calls to the DSL defined in <a
href="BaseDSL.html">ApiTools::Presenters::BaseDSL</a> in order to define
the schema.</p>
</dd></dl>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-schema_source')" id="l_method-c-schema_source">show</a>
                
              </p>
              <div id="method-c-schema_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/api_tools/presenters/base_presenter.rb, line 16</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">schema</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@schema</span> = <span class="ruby-constant">ApiTools</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Object</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@schema</span>.<span class="ruby-identifier">instance_eval</span> <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-validate">
            
              <b>validate</b>(data)
            
            <a href="../../../classes/ApiTools/Presenters/BasePresenter.html#method-c-validate" name="method-c-validate" class="permalink">Link</a>
          </div>
          
          
            <div class="description">
              <p>Given JSON data that&#39;s been parsed from a <a
href="String.html">String</a> into an equivalent Ruby <a
href="Hash.html">Hash</a>, with <a href="String.html">String</a> keys,
validate that data against the schema and return an <a
href="../Errors.html">ApiTools::Errors</a> instance. This will contain
*zero or more* errors; if zero, there is no problem, else validation
failures are described.</p>
<dl class="rdoc-list note-list"><dt><code>data</code>
<dd>
<p>Ruby <a href="Hash.html">Hash</a> representation of JSON data that is to be
validated against &#39;this&#39; schema. Keys must be Strings, not Symbols.</p>
</dd></dl>
            </div>
          
          
          

          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-validate_source')" id="l_method-c-validate_source">show</a>
                
              </p>
              <div id="method-c-validate_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/api_tools/presenters/base_presenter.rb, line 30</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-identifier">data</span>)
  <span class="ruby-ivar">@schema</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-identifier">data</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                        </div>

    </div>
  </body>
</html>    