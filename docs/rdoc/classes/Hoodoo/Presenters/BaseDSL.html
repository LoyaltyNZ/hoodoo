<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Hoodoo::Presenters::BaseDSL</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/github.css" type="text/css" media="screen" />
<script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="Hoodoo::Presenters::BaseDSL">

    <meta name="description" content="A mixin to be used by any presenter that wants to support the Hoodoo::Presenters family of schema DSL methods. See e.g. Hoodoo::Presenters::Base. Mixed in by e.g.">
    <meta property="og:description" content="A mixin to be used by any presenter that wants to support the Hoodoo::Presenters family of schema DSL methods. See e.g. Hoodoo::Presenters::Base. Mixed in by e.g.">

    <meta name="keywords" content="Hoodoo::Presenters::BaseDSL class">
    <meta name="keywords" content="object, array, hash, integer, string, float, decimal, boolean, date, datetime, text, enum, tags, uuid, type, resource, internationalised, is_internationalised?">
</head>

<body>
    <div class="banner">
        <h1>
            <span class="type">Module</span>
            Hoodoo::Presenters::BaseDSL
        </h1>
        <ul class="files">
            <li><a href="../../../files/lib/hoodoo/presenters/base_dsl_rb.html">lib/hoodoo/presenters/base_dsl.rb</a></li>
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
    <div class="description">
        
<p>A mixin to be used by any presenter that wants to support the <a
href="../Presenters.html">Hoodoo::Presenters</a> family of schema DSL
methods. See e.g. <a href="Base.html">Hoodoo::Presenters::Base</a>. Mixed
in by e.g. <a href="Object.html">Hoodoo::Presenters::Object</a> so that an
instance can nest definitions of fields inside itself using this DSL.</p>

    </div>




    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
        <dt>A</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-array">array</a>
                </li>
            </ul>
        </dd>
        <dt>B</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-boolean">boolean</a>
                </li>
            </ul>
        </dd>
        <dt>D</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-date">date</a>,
                </li>
                <li>
                    <a href="#method-i-datetime">datetime</a>,
                </li>
                <li>
                    <a href="#method-i-decimal">decimal</a>
                </li>
            </ul>
        </dd>
        <dt>E</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-enum">enum</a>
                </li>
            </ul>
        </dd>
        <dt>F</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-float">float</a>
                </li>
            </ul>
        </dd>
        <dt>H</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-hash">hash</a>
                </li>
            </ul>
        </dd>
        <dt>I</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-integer">integer</a>,
                </li>
                <li>
                    <a href="#method-i-internationalised">internationalised</a>,
                </li>
                <li>
                    <a href="#method-i-is_internationalised-3F">is_internationalised?</a>
                </li>
            </ul>
        </dd>
        <dt>O</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-object">object</a>
                </li>
            </ul>
        </dd>
        <dt>R</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-resource">resource</a>
                </li>
            </ul>
        </dd>
        <dt>S</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-string">string</a>
                </li>
            </ul>
        </dd>
        <dt>T</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-tags">tags</a>,
                </li>
                <li>
                    <a href="#method-i-text">text</a>,
                </li>
                <li>
                    <a href="#method-i-type">type</a>
                </li>
            </ul>
        </dd>
        <dt>U</dt>
        <dd>
            <ul>
                <li>
                    <a href="#method-i-uuid">uuid</a>
                </li>
            </ul>
        </dd>
    </dl>






<!-- Methods -->

    <div class="sectiontitle">Instance Public methods</div>
    <div class="method">
        <div class="title method-title" id="method-i-array">
            <b>array</b>( name, options = {}, &amp;block )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-array" name="method-i-array" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON array with the supplied name and options. If there is a block
provided, then more DSL calls inside the block define how each array entry
must look; otherwise array entries are not validated / are undefined unless
the <code>:type</code> option is specified (see below).</p>

<p>When an array uses <code>:required =&gt; true</code>, this only says that
at least an empty array must be present, nothing more. If the array uses a
block with fields that themselves are required, then this is only checked
for if the array contains one or more entries (and is checked for each of
those entries).</p>
<dl class="rdoc-list note-list"><dt><code>name</code>
<dd>
<p>The JSON key</p>
</dd><dt><code>options</code>
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code></p>
</dd><dt>&amp;block
<dd>
<p>Optional block declaring the fields of each array item</p>
</dd></dl>

<p><a href="Array.html">Array</a> entries are normally either unvalidated, or
describe complex types via a block. For simple fields, pass a :type option
to declare that array entries must be of supported types as follows:</p>
<dl class="rdoc-list label-list"><dt>:array
<dd>
<p><a href="Array.html">Hoodoo::Presenters::Array</a> (see <a
href="BaseDSL.html#method-i-array">array</a>)</p>
</dd><dt>:boolean
<dd>
<p><a href="Boolean.html">Hoodoo::Presenters::Boolean</a> (see <a
href="BaseDSL.html#method-i-boolean">boolean</a>)</p>
</dd><dt>:date
<dd>
<p><a href="Date.html">Hoodoo::Presenters::Date</a> (see <a
href="BaseDSL.html#method-i-date">date</a>)</p>
</dd><dt>:date_time
<dd>
<p><a href="DateTime.html">Hoodoo::Presenters::DateTime</a> (see <a
href="BaseDSL.html#method-i-datetime">datetime</a>)</p>
</dd><dt>:decimal
<dd>
<p><a href="Decimal.html">Hoodoo::Presenters::Decimal</a> (see <a
href="BaseDSL.html#method-i-decimal">decimal</a>)</p>
</dd><dt>:enum
<dd>
<p><a href="Enum.html">Hoodoo::Presenters::Enum</a> (see <a
href="BaseDSL.html#method-i-enum">enum</a>)</p>
</dd><dt>:float
<dd>
<p><a href="Float.html">Hoodoo::Presenters::Float</a> (see <a
href="BaseDSL.html#method-i-float">float</a>)</p>
</dd><dt>:integer
<dd>
<p><a href="Integer.html">Hoodoo::Presenters::Integer</a> (see <a
href="BaseDSL.html#method-i-integer">integer</a>)</p>
</dd><dt>:string
<dd>
<p><a href="String.html">Hoodoo::Presenters::String</a> (see <a
href="BaseDSL.html#method-i-string">string</a>)</p>
</dd><dt>:tags
<dd>
<p><a href="Tags.html">Hoodoo::Presenters::Tags</a> (see <a
href="BaseDSL.html#method-i-tags">tags</a>)</p>
</dd><dt>:text
<dd>
<p><a href="Text.html">Hoodoo::Presenters::Text</a> (see <a
href="BaseDSL.html#method-i-text">text</a>)</p>
</dd><dt>:uuid
<dd>
<p><a href="UUID.html">Hoodoo::Presenters::UUID</a> (see <a
href="BaseDSL.html#method-i-uuid">uuid</a>)</p>
</dd></dl>

<p>Some of these types require additional parameters, such as
<code>:precision</code> for <a
href="Decimal.html">Hoodoo::Presenters::Decimal</a> or <code>:from</code>
for <a href="Enum.html">Hoodoo::Presenters::Enum</a>. For <em>any</em>
options that are to apply to the the new <a href="Array.html">Array</a>
simple type fields, prefix the option with the string <code>field_</code> -
for example, <code>:field_precision =&gt; 2</code>.</p>

<p>It does not make sense to attempt to apply field defaults to simple type
array entries via <code>:field_default</code>; don&#39;t do this.</p>

<p>In the case of <code>:type =&gt; :array</code>, the declaring <a
href="Array.html">Array</a> is saying that its entries are themselves
individually Arrays. This means that validation will ensure and rendering
will assume that each of the parent <a href="Array.html">Array</a> entries
are themselves Arrays, but will not validte the child <a
href="Array.html">Array</a> contents any further. It is not possible to
declare an <a href="Array.html">Array</a> with a child <a
href="Array.html">Array</a> that has further children, or has child-level
validation; instead you would need to use the block syntax, so that the
child <a href="Array.html">Array</a> was associated to some named key in
the arising Object/Hash making up each of the parent entries.</p>

<h2 id="method-i-array-label-Block+syntax+example">Block syntax example</h2>

<p>Mandatory JSON field “currencies” would lead to an array where each array
entry contains the fields defined by Hoodoo::Data::Types::Currency along
with an up-to-32 character string with field name “notes”, that field also
being required. Whether or not the fields of the referenced Currency type
are needed is up to the definition of that type. See <a
href="BaseDSL.html#method-i-type">type</a> for more information.</p>

<pre><code>class VeryWealthy &lt; Hoodoo::Presenters::Base
  schema do
    array :currencies, :required =&gt; true do
      type :Currency
      string :notes, :required =&gt; true, :length =&gt; 32
    end
  end
end
</code></pre>

<h2 id="method-i-array-label-Simple+type+syntax+without+field+options">Simple type syntax without field options</h2>

<p>An optional <a href="Array.html">Array</a> which consists of simple UUIDs
as its entries:</p>

<pre><code>class UUIDCollection &lt; Hoodoo::Presenters::Base
  schema do
    array :uuids, :type =&gt; :uuid
  end
end

# E.g.:
#
# {
#   &quot;uuids&quot; =&gt; [ &quot;...uuid...&quot;, &quot;...uuid...&quot;, ... ]
# }
</code></pre>

<p>Validation of data intended to be rendered through such a schema
declaration would make sure that each array entry was UUID-like.</p>

<h2 id="method-i-array-label-Simple+type+syntax+with+field+options">Simple type syntax with field options</h2>

<p>An optional <a href="Array.html">Array</a> which consists of Decimals with
precision 2:</p>

<pre><code>class DecimalCollection &lt; Hoodoo::Presenters::Base
  schema do
    array :numbers, :type =&gt; :decimal, :field_precision =&gt; 2
  end
end

# E.g.:
#
# {
#   &quot;numbers&quot; =&gt; [ BigDecimal.new( &#39;2.2511&#39; ) ]
# }
</code></pre>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-array_source')" id="l_method-i-array_source">show</a>
            </p>
            <div id="method-i-array_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 167</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">array</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
  <span class="ruby-identifier">ary</span> = <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Array</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
  <span class="ruby-identifier">internationalised</span>() <span class="ruby-keyword">if</span> <span class="ruby-identifier">ary</span>.<span class="ruby-identifier">is_internationalised?</span>()
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-boolean">
            <b>boolean</b>( name, options = {} )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-boolean" name="method-i-boolean" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON boolean with the supplied name and options.</p>
<dl class="rdoc-list note-list"><dt>name
<dd>
<p>The JSON key</p>
</dd><dt>options
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code></p>
</dd></dl>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-boolean_source')" id="l_method-i-boolean_source">show</a>
            </p>
            <div id="method-i-boolean_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 374</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">boolean</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {} )
  <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Boolean</span>, <span class="ruby-identifier">options</span> )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-date">
            <b>date</b>( name, options = {} )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-date" name="method-i-date" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON date with the supplied name and options.</p>
<dl class="rdoc-list note-list"><dt>name
<dd>
<p>The JSON key</p>
</dd><dt>options
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code></p>
</dd></dl>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-date_source')" id="l_method-i-date_source">show</a>
            </p>
            <div id="method-i-date_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 383</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">date</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {} )
  <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Date</span>, <span class="ruby-identifier">options</span> )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-datetime">
            <b>datetime</b>( name, options = {} )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-datetime" name="method-i-datetime" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON datetime with the supplied name and options.</p>
<dl class="rdoc-list note-list"><dt>name
<dd>
<p>The JSON key</p>
</dd><dt>options
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code></p>
</dd></dl>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-datetime_source')" id="l_method-i-datetime_source">show</a>
            </p>
            <div id="method-i-datetime_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 392</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">datetime</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {} )
  <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">DateTime</span>, <span class="ruby-identifier">options</span> )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-decimal">
            <b>decimal</b>( name, options = {} )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-decimal" name="method-i-decimal" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON decimal with the supplied name and options.</p>
<dl class="rdoc-list note-list"><dt>name
<dd>
<p>The JSON key</p>
</dd><dt>options
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code> and
mandatory <code>:precision =&gt; [decimal-precision-number]</code></p>
</dd></dl>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-decimal_source')" id="l_method-i-decimal_source">show</a>
            </p>
            <div id="method-i-decimal_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 365</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decimal</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {} )
  <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Decimal</span>, <span class="ruby-identifier">options</span> )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-enum">
            <b>enum</b>( name, options = {} )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-enum" name="method-i-enum" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON string which can only have a restricted set of exactly
matched values, with the supplied name and options.</p>
<dl class="rdoc-list note-list"><dt><code>name</code>
<dd>
<p>The JSON key</p>
</dd><dt><code>options</code>
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code> and
mandatory <code>:from =&gt; [array-of-allowed-strings-or-symbols]</code></p>
</dd></dl>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-enum_source')" id="l_method-i-enum_source">show</a>
            </p>
            <div id="method-i-enum_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 414</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">enum</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {} )
  <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Enum</span>, <span class="ruby-identifier">options</span> )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-float">
            <b>float</b>( name, options = {} )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-float" name="method-i-float" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON float with the supplied name and options.</p>
<dl class="rdoc-list note-list"><dt>name
<dd>
<p>The JSON key</p>
</dd><dt>options
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code></p>
</dd></dl>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-float_source')" id="l_method-i-float_source">show</a>
            </p>
            <div id="method-i-float_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 355</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">float</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {} )
  <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Float</span>, <span class="ruby-identifier">options</span> )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-hash">
            <b>hash</b>( name, options = {}, &amp;block )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-hash" name="method-i-hash" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON object with the supplied name and optional constraints on
properties (like hash keys) and property values (like hash values) that the
object may contain, in abstract terms.</p>
<dl class="rdoc-list note-list"><dt><code>name</code>
<dd>
<p>The JSON key</p>
</dd><dt><code>options</code>
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code></p>
</dd><dt>&amp;block
<dd>
<p>Optional block declaring the fields making up the nested hash</p>
</dd></dl>

<h2 id="method-i-hash-label-Block-based+complex+type+examples">Block-based complex type examples</h2>

<h3 id="method-i-hash-label-Example+1">Example 1</h3>

<p>A <a href="Hash.html">Hash</a> where keys must be &lt;= 16 characters long
and values must match a <code>Hoodoo::Data::Types::Currency</code> type
(with the default <a href="../Data/Types.html">Hoodoo::Data::Types</a>
namespace use arising from the Symbol passed to the <a
href="BaseDSL.html#method-i-type">type</a> method).</p>

<pre><code>class CurrencyHash &lt; Hoodoo::Presenters::Base
  schema do
    hash :currencies do
      keys :length =&gt; 16 do
        type :Currency
      end
    end
  end
end
</code></pre>

<p>See <a href="Hash.html#method-i-keys">Hoodoo::Presenters::Hash#keys</a> for
more information and examples.</p>

<h3 id="method-i-hash-label-Example+2">Example 2</h3>

<p>A <a href="Hash.html">Hash</a> where keys must be &#39;one&#39; or
&#39;two&#39;, each with a value matching the given schema. Here, the
example assumes that a subclass of <a
href="Base.html">Hoodoo::Presenters::Base</a> has been defined under the
name of <code>SomeNamespace::Types::Currency</code>, since this is passed
as a class reference to the <a href="BaseDSL.html#method-i-type">type</a>
method.</p>

<pre><code>class AltCurrencyHash &lt; Hoodoo::Presenters::Base
  schema do
    hash :currencies do
      key :one do
        type SomeNamespace::Types::Currency
      end

      key :two do
        text :title
        text :description
      end
    end
  end
end
</code></pre>

<p>See <a href="Hash.html#method-i-key">Hoodoo::Presenters::Hash#key</a> for
more information and examples.</p>

<h2 id="method-i-hash-label-Simple+types">Simple types</h2>

<p>As with <a href="BaseDSL.html#method-i-array">array</a>, simple types can
be declared for <a href="Hash.html">Hash</a> key values by passing a
<code>:type</code> option to <a
href="Hash.html#method-i-key">Hoodoo::Presenters::Hash#key</a> or <a
href="Hash.html#method-i-keys">Hoodoo::Presenters::Hash#keys</a>. See the
<a href="BaseDSL.html#method-i-array">array</a> documentation for a list of
permitted types.</p>

<p>For individual specific keys in <a
href="Hash.html#method-i-key">Hoodoo::Presenters::Hash#key</a>, it
<em>does</em> make sense sometimes to specify field defaults using either a
<code>:default</code> or <code>:field_default</code> key (they are
synonyms). For arbitrary keys via <a
href="Hash.html#method-i-keys">Hoodoo::Presenters::Hash#keys</a> the
situation is the same as with array entries and it does <em>not</em> make
sense to specify field defaults.</p>

<h3 id="method-i-hash-label-Simple+type+example">Simple type example</h3>

<pre><code>class Person &lt; Hoodoo::Presenters::Base
  schema do
    hash :name do
      key :first, :type =&gt; :text
      key :last,  :type =&gt; :text
    end

    hash :address do
      keys :type =&gt; :text
    end

    hash :identifiers, :required =&gt; true do
      keys :length =&gt; 8, :type =&gt; :string, :field_length =&gt; 32
    end
  end
end
</code></pre>

<p>The optional <a href="Hash.html">Hash</a> called <code>name</code> has two
optional keys which must be called <code>first</code> or <code>last</code>
and have values that conform to <a
href="Text.html">Hoodoo::Presenters::Text</a>.</p>

<p>The optional <a href="Hash.html">Hash</a> called <code>address</code> has
arbitrarily named unbounded length keys which where present must conform to
<a href="Text.html">Hoodoo::Presenters::Text</a>.</p>

<p>The required <a href="Hash.html">Hash</a> called <code>identifiers</code>
hash arbitrarily named keys with a maximum length of 8 characters which
must have values that conform to <a
href="String.html">Hoodoo::Presenters::String</a> and are each no more than
32 characters long.</p>

<p>Therefore the following payload is valid:</p>

<pre><code>data = {
  &quot;name&quot; =&gt; {
    &quot;first&quot; =&gt; &quot;Test&quot;,
    &quot;last&quot; =&gt; &quot;Testy&quot;
  },
  &quot;address&quot; =&gt; {
    &quot;road&quot; =&gt; &quot;1 Test Street&quot;,
    &quot;city&quot; =&gt; &quot;Testville&quot;,
    &quot;post_code&quot; =&gt; &quot;T01 C41&quot;
  },
  &quot;identifiers&quot; =&gt; {
    &quot;primary&quot; =&gt; &quot;9759c77d188f4bfe85959738dc6f8505&quot;,
    &quot;postgres&quot; =&gt; &quot;1442&quot;
  }
}

Person.validate( data )
# =&gt; []
</code></pre>

<p>The following example contains numerous mistakes:</p>

<pre><code>data = {
  &quot;name&quot; =&gt; {
    &quot;first&quot; =&gt; &quot;Test&quot;,
    &quot;surname&quot; =&gt; &quot;Testy&quot; # Invalid key name
  },
  &quot;address&quot; =&gt; {
    &quot;road&quot; =&gt; &quot;1 Test Street&quot;,
    &quot;city&quot; =&gt; &quot;Testville&quot;,
    &quot;zip&quot; =&gt; 90421 # Integer, not Text
  },
  &quot;identifiers&quot; =&gt; {
    &quot;primary&quot; =&gt; &quot;9759c77d188f4bfe85959738dc6f8505_441&quot;, # Value too long
    &quot;postgresql&quot; =&gt; &quot;1442&quot; # Key name too long
  }
}

Person.validate( data )
# =&gt; [{&quot;code&quot;=&gt;&quot;generic.invalid_hash&quot;,
#      &quot;message&quot;=&gt;&quot;Field `name` is an invalid hash due to unrecognised keys `surname`&quot;,
#      &quot;reference&quot;=&gt;&quot;name&quot;},
#     {&quot;code&quot;=&gt;&quot;generic.invalid_string&quot;,
#      &quot;message&quot;=&gt;&quot;Field `address.zip` is an invalid string&quot;,
#      &quot;reference&quot;=&gt;&quot;address.zip&quot;},
#     {&quot;code&quot;=&gt;&quot;generic.invalid_string&quot;,
#      &quot;message&quot;=&gt;&quot;Field `identifiers.primary` is longer than maximum length `32`&quot;,
#      &quot;reference&quot;=&gt;&quot;identifiers.primary&quot;},
#     {&quot;code&quot;=&gt;&quot;generic.invalid_string&quot;,
#      &quot;message&quot;=&gt;&quot;Field `identifiers.postgresql` is longer than maximum length `8`&quot;,
#      &quot;reference&quot;=&gt;&quot;identifiers.postgresql&quot;}]
</code></pre>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-hash_source')" id="l_method-i-hash_source">show</a>
            </p>
            <div id="method-i-hash_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 326</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">hash</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
  <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Hash</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
  <span class="ruby-identifier">internationalised</span>() <span class="ruby-keyword">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">is_internationalised?</span>()
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-integer">
            <b>integer</b>( name, options = {} )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-integer" name="method-i-integer" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON integer with the supplied name and options.</p>
<dl class="rdoc-list note-list"><dt>name
<dd>
<p>The JSON key</p>
</dd><dt>options
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code></p>
</dd></dl>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-integer_source')" id="l_method-i-integer_source">show</a>
            </p>
            <div id="method-i-integer_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 336</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">integer</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {} )
  <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Integer</span>, <span class="ruby-identifier">options</span> )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-internationalised">
            <b>internationalised</b>( options = nil )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-internationalised" name="method-i-internationalised" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Declares that this Type or Resource contains fields which will may carry
human-readable data subject to platform interntionalisation rules. A
Resource which is internationalised automatically gains a
<code>language</code> field (part of the Platform API&#39;s Common Fields)
used in resource representations. A Type which is internationalised gains
nothing until it is cross-referenced by a Resource definion, at which point
the cross-referencing resource becomes itself implicitly internationalised
(so it “taints” the resource). For cross-referencing, see <a
href="BaseDSL.html#method-i-type">type</a>.</p>
<dl class="rdoc-list note-list"><dt><code>options</code>
<dd>
<p>Optional options hash. No options currently defined.</p>
</dd></dl>

<p>Example - a Member resource with internationalised fields such as the
member&#39;s name:</p>

<pre><code>class Member &lt; Hoodoo::Presenters::Base
  schema do

    # Say that Member will contain at least one field that holds
    # human readable data, causing the Member to be subject to
    # internationalisation rules.

    internationalised

    # Declare fields as normal, for example...

    text :name

  end
end
</code></pre>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-internationalised_source')" id="l_method-i-internationalised_source">show</a>
            </p>
            <div id="method-i-internationalised_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 683</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">internationalised</span>( <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span> )
  <span class="ruby-identifier">options</span> <span class="ruby-operator">||=</span> {}
  <span class="ruby-ivar">@internationalised</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-is_internationalised-3F">
            <b>is_internationalised?</b>()
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-is_internationalised-3F" name="method-i-is_internationalised-3F" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>An enquiry method related to, but not part of the DSL; returns
<code>true</code> if the schema instance is internationalised, else
<code>false</code>.</p>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-is_internationalised-3F_source')" id="l_method-i-is_internationalised-3F_source">show</a>
            </p>
            <div id="method-i-is_internationalised-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 691</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">is_internationalised?</span>
  <span class="ruby-operator">!</span><span class="ruby-operator">!</span> <span class="ruby-ivar">@internationalised</span>
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-object">
            <b>object</b>( name, options = {}, &amp;block )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-object" name="method-i-object" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON object with the supplied name and options.</p>
<dl class="rdoc-list note-list"><dt>name
<dd>
<p>The JSON key.</p>
</dd><dt>options
<dd>
<p>Optional <code>Hash</code> of options, e.g. <code>:required =&gt;
true</code></p>
</dd><dt>&amp;block
<dd>
<p>Block declaring the fields making up the nested object</p>
</dd></dl>

<p>Example - mandatory JSON field “currencies” would lead to an object which
had the same fields as Hoodoo::Data::Types::Currency along with an up-to-32
character string with field name “notes”, that field also being required.
Whether or not the fields of the referenced Currency type are needed is up
to the definition of that type. See <a
href="BaseDSL.html#method-i-type">type</a> for more information.</p>

<pre><code>class Wealthy &lt; Hoodoo::Presenters::Base
  schema do
    object :currencies, :required =&gt; true do
      type :Currency
      string :notes, :required =&gt; true, :length =&gt; 32
    end
  end
end
</code></pre>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-object_source')" id="l_method-i-object_source">show</a>
            </p>
            <div id="method-i-object_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 44</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">object</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>( <span class="ruby-string">&#39;Hoodoo::Presenters::Base#Object must have block&#39;</span> ) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block_given?</span>

  <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Object</span>, <span class="ruby-identifier">options</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span> )
  <span class="ruby-identifier">internationalised</span>() <span class="ruby-keyword">if</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">is_internationalised?</span>()
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-resource">
            <b>resource</b>( resource_info, options = nil )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-resource" name="method-i-resource" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Declare that a resource of a given name is included at this point. This is
only normally done within the description of the schema for an interface.
The fields of the given named resource are considered to be defined inline
at the point of declaration - essentially, it&#39;s macro expansion.</p>
<dl class="rdoc-list note-list"><dt><code>resource_info</code>
<dd>
<p>The <a href="Base.html">Hoodoo::Presenters::Base</a> subclass for the
Resource in question, e.g. <code>Product</code>. The deprecated form of
this interface takes the name of the type to nest as a symbol, e.g.
<code>:Product</code>, in which case the Resource must be declared within
nested modules <a href="../Data/Types.html">Hoodoo::Data::Types</a>.</p>
</dd><dt><code>options</code>
<dd>
<p>Optional options hash. No options currently defined.</p>
</dd></dl>

<p>Example - an iterface takes an <code>Outlet</code> resource in its create
action.</p>

<pre><code>class Outlet &lt; Hoodoo::Presenters::Base
  schema do
    internationalised

    text :name
    uuid :participant_id, :resource =&gt; :Participant, :required =&gt; true
    uuid :calculator_id,  :resource =&gt; :Calculator
  end
end

class OutletInterface &lt; Hoodoo::Services::Interface
  to_create do
    resource Outlet
  end
end
</code></pre>

<p>It doesn&#39;t make sense to mark a <code>resource</code> &#39;field&#39;
as <code>:required</code> in the options since the declaration just expands
to the contents of the referenced resource and it is the definition of that
resource that determines whether or not its various field(s) are optional /
required. That is, the following two declarations behave identically:</p>

<pre><code>resource Outlet

resource Outlet, :required =&gt; true # Pointless option!
</code></pre>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-resource_source')" id="l_method-i-resource_source">show</a>
            </p>
            <div id="method-i-resource_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 636</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">resource</span>( <span class="ruby-identifier">resource_info</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span> )
  <span class="ruby-identifier">options</span> <span class="ruby-operator">||=</span> {}

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">resource_info</span>.<span class="ruby-identifier">is_a?</span>( <span class="ruby-constant">Class</span> ) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">resource_info</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
    <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">resource_info</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">klass</span> = <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Data</span><span class="ruby-operator">::</span><span class="ruby-constant">Resources</span>.<span class="ruby-identifier">const_get</span>( <span class="ruby-identifier">resource_info</span> )
    <span class="ruby-keyword">rescue</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Hoodoo::Presenters::Base\#resource: Unrecognised resource name &#39;#{ resource_info }&#39;&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">instance_exec</span>( <span class="ruby-operator">&amp;</span><span class="ruby-identifier">klass</span>.<span class="ruby-identifier">get_schema_definition</span>() )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-string">
            <b>string</b>( name, options = {} )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-string" name="method-i-string" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON string with the supplied name and options.</p>
<dl class="rdoc-list note-list"><dt>name
<dd>
<p>The JSON key</p>
</dd><dt>options
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code> and
mandatory <code>:length =&gt; [max-length-in-chars]</code></p>
</dd></dl>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-string_source')" id="l_method-i-string_source">show</a>
            </p>
            <div id="method-i-string_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 346</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">string</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {} )
  <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">String</span>, <span class="ruby-identifier">options</span> )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-tags">
            <b>tags</b>( field_name, options = nil )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-tags" name="method-i-tags" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Declares that this Type or Resource has a string field of unlimited length
that contains comma-separated tag strings.</p>
<dl class="rdoc-list note-list"><dt><code>field_name</code>
<dd>
<p>Name of the field that will hold the tags.</p>
</dd><dt><code>options</code>
<dd>
<p>Optional options hash. See <a
href="BaseDSL.html">Hoodoo::Presenters::BaseDSL</a>.</p>
</dd></dl>

<p>Example - a Product resource which supports product tagging:</p>

<pre><code>class Product &lt; Hoodoo::Presenters::Base
  schema do
    internationalised

    text :name
    text :description
    string :sku, :length =&gt; 64
    tags :tags
  end
end
</code></pre>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-tags_source')" id="l_method-i-tags_source">show</a>
            </p>
            <div id="method-i-tags_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 437</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">tags</span>( <span class="ruby-identifier">field_name</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span> )
  <span class="ruby-identifier">options</span> <span class="ruby-operator">||=</span> {}
  <span class="ruby-identifier">property</span>( <span class="ruby-identifier">field_name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Tags</span>, <span class="ruby-identifier">options</span> )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-text">
            <b>text</b>( name, options = {} )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-text" name="method-i-text" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Define a JSON string of unlimited length with the supplied name and
options.</p>
<dl class="rdoc-list note-list"><dt>name
<dd>
<p>The JSON key</p>
</dd><dt>options
<dd>
<p>A <code>Hash</code> of options, e.g. <code>:required =&gt; true</code></p>
</dd></dl>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-text_source')" id="l_method-i-text_source">show</a>
            </p>
            <div id="method-i-text_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 402</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text</span>( <span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span> = {} )
  <span class="ruby-identifier">property</span>( <span class="ruby-identifier">name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Text</span>, <span class="ruby-identifier">options</span> )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-type">
            <b>type</b>( type_info, options = nil )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-type" name="method-i-type" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Declare that a nested type of a given name is included at this point. This
is only normally done within an <code>array</code> or <code>object</code>
declaration. The fields of the given named type are considered to be
defined inline at the point of declaration - essentially, it&#39;s macro
expansion.</p>
<dl class="rdoc-list note-list"><dt><code>type_info</code>
<dd>
<p>The <a href="Base.html">Hoodoo::Presenters::Base</a> subclass for the Type
in question, e.g. <code>BasketItem</code>. The deprecated form of this
interface takes the name of the type to nest as a symbol, e.g.
<code>:BasketItem</code>, in which case the Type must be declared within
nested modules <a href="../Data/Types.html">Hoodoo::Data::Types</a>.</p>
</dd><dt><code>options</code>
<dd>
<p>Optional options hash. No options currently defined.</p>
</dd></dl>

<p>It doesn&#39;t make sense to mark a <code>type</code> &#39;field&#39; as
<code>:required</code> in the options since the declaration just expands to
the contents of the referenced type and it is the definition of that type
that determines whether or not its various field(s) are optional or
required.</p>

<p>Example 1 - a basket includes an array of the Type described by class
<code>BasketItem</code>:</p>

<pre><code>class Basket &lt; Hoodoo::Presenters::Base
  schema do
    array :items do
      type BasketItem
    end
  end
end
</code></pre>

<p>A fragment of JSON for a basket might look like this:</p>

<pre><code>{
  &quot;items&quot;: [
    {
       // (First BasketItem&#39;s fields)
    },
    {
       // (First BasketItem&#39;s fields)
    },
    // etc.
  ]
}</code></pre>

<p>Example 2 - a basket item refers to a product description by having its
fields inline. So suppose we have this:</p>

<pre><code>class Product &lt; Hoodoo::Presenters::Base
  schema do
    internationalised
    text :name
    text :description
  end
end

class BasketItem &lt; Hoodoo::Presenters::Base
  schema do
    object :product_data do
      type Product
    end
  end
end
</code></pre>

<p>…then this would be a valid BasketItem fragment of JSON:</p>

<pre><code>{
  &quot;product_data&quot;: {
    &quot;name&quot;: &quot;Washing powder&quot;,
    &quot;description&quot;: &quot;Washes whiter than white!&quot;
  }
}
</code></pre>

<p>It is also possible to use this mechanism for inline expansions when you
have, say, a Resource defined <em>entirely</em> in terms of something
reused elsewhere as a Type. For example, suppose the product/basket
information from above included information on a Currency that was used for
payment. It might reuse a Type; meanwhile we might have a resource for
managing Currencies, defined entirely through that Type:</p>

<pre><code>class Currency &lt; Hoodoo::Presenters::Base
  schema do
    string :curency_code, :required =&gt; true, :length =&gt; 8
    string :symbol, :length =&gt; 16
    integer :multiplier, :default =&gt; 100
    array :qualifiers do
      string :qualifier, :length =&gt; 32
    end
  end
end

resource :Currency do
  schema do
    type Currency # Fields are *inline*
  end
end
</code></pre>

<p>This means that the <strong>Resource</strong> of <code>Currency</code> has
exactly the same fields as the <strong>Type</strong> of Currency. The
Resource could define other fields too, though this would be risky as the
Type might gain same-named fields in future, leading to undefined
behaviour. At such a time, a degree of cut-and-paste and removing the
<code>type</code> call from the Resource definition would probably be wise.</p>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-type_source')" id="l_method-i-type_source">show</a>
            </p>
            <div id="method-i-type_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 577</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">type</span>( <span class="ruby-identifier">type_info</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span> )
  <span class="ruby-identifier">options</span> <span class="ruby-operator">||=</span> {}

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">type_info</span>.<span class="ruby-identifier">is_a?</span>( <span class="ruby-constant">Class</span> ) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">type_info</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
    <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">type_info</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">klass</span> = <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Data</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>.<span class="ruby-identifier">const_get</span>( <span class="ruby-identifier">type_info</span> )
    <span class="ruby-keyword">rescue</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Hoodoo::Presenters::Base\#type: Unrecognised type name &#39;#{ type_info }&#39;&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">instance_exec</span>( <span class="ruby-operator">&amp;</span><span class="ruby-identifier">klass</span>.<span class="ruby-identifier">get_schema_definition</span>() )
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
    <div class="method">
        <div class="title method-title" id="method-i-uuid">
            <b>uuid</b>( field_name, options = nil )
            <a href="../../../classes/Hoodoo/Presenters/BaseDSL.html#method-i-uuid" name="method-i-uuid" class="permalink">Link</a>
        </div>

        <div class="description">
            <p>Declares that this Type or Resource _refers to_ another Resource instance
via its <a href="UUID.html">UUID</a>. There&#39;s no need to declare the
presence of the <a href="UUID.html">UUID</a> field _for the instance
itself_ on all resource definitions as that&#39;s implicit; this <a
href="BaseDSL.html#method-i-uuid">uuid</a> method is just for relational
information (AKA associations).</p>
<dl class="rdoc-list note-list"><dt><code>field_name</code>
<dd>
<p>Name of the field that will hold the <a href="UUID.html">UUID</a>.</p>
</dd><dt><code>options</code>
<dd>
<p>Options hash. See below.</p>
</dd></dl>

<p>In addition to standard options from <a
href="BaseDSL.html">Hoodoo::Presenters::BaseDSL</a>, extra option keys and
values are:</p>
<dl class="rdoc-list note-list"><dt><code>:resource</code>
<dd>
<p>The name of a resource (as a symbol, e.g. <code>:Product</code>) that the
<a href="UUID.html">UUID</a> should refer to. Implementations <em>may</em>
use this to validate that the resource, where a <a
href="UUID.html">UUID</a> is provided, really is for a Product instance and
not something else. Optional.</p>
</dd></dl>

<p>Example - a basket item that refers to an integer quantity of some specific
Product resource instance:</p>

<pre><code>class BasketItem &lt; Hoodoo::Presenters::Base
  schema do
    integer :quantity, :required =&gt; true
    uuid :product_id, :resource =&gt; :Product
  end
end
</code></pre>
        </div>



        <div class="sourcecode">

            <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-uuid_source')" id="l_method-i-uuid_source">show</a>
            </p>
            <div id="method-i-uuid_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/hoodoo/presenters/base_dsl.rb, line 470</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">uuid</span>( <span class="ruby-identifier">field_name</span>, <span class="ruby-identifier">options</span> = <span class="ruby-keyword">nil</span> )
  <span class="ruby-identifier">options</span> <span class="ruby-operator">||=</span> {}
  <span class="ruby-identifier">property</span>(<span class="ruby-identifier">field_name</span>, <span class="ruby-constant">Hoodoo</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">UUID</span>, <span class="ruby-identifier">options</span>)
<span class="ruby-keyword">end</span></pre>
            </div>
        </div>
    </div>
</div>

    </div>
  </body>
</html>
