<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class ApiTools::Presenters::BasePresenter - ApiTools</title>

<link href="../../fonts.css" rel="stylesheet">
<link href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/navigation.js"></script>
<script src="../../js/search_index.js"></script>
<script src="../../js/search.js"></script>
<script src="../../js/searcher.js"></script>
<script src="../../js/darkfish.js"></script>


<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-get_schema">::get_schema</a>
    
    <li ><a href="#method-c-render">::render</a>
    
    <li ><a href="#method-c-schema">::schema</a>
    
    <li ><a href="#method-c-validate">::validate</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-ApiTools::Presenters::BasePresenter">
  <h1 id="class-ApiTools::Presenters::BasePresenter" class="class">
    class ApiTools::Presenters::BasePresenter
  </h1>

  <section class="description">
    
<p>Base functionality for JSON validation and presenter (rendering) layers.
Subclass this to define a schema against which validation of inbound data
or rendering of outbound data can be performed. Call <a
href="BasePresenter.html#method-c-schema">::schema</a> in the subclass to
declare, via the DSL, the shape of the schema.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-get_schema" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_schema</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return the schema graph.</p>
          
          

          
          <div class="method-source-code" id="get_schema-source">
            <pre><span class="ruby-comment"># File lib/api_tools/presenters/base_presenter.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">get_schema</span>
  <span class="ruby-ivar">@schema</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-render" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">render</span><span
            class="method-args">(data)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Given some data that should conform to the subclass presenter&#39;s schema,
render it to go from the input Ruby <a href="Hash.html">Hash</a>, to an
output Ruby <a href="Hash.html">Hash</a> which will include default values
- if any - present in the schema and will drop input fields not present in
that schema. In essence, this takes data which may have been
programatically generated and sanitises it to produce valid, with-defaults
guaranteed valid output.</p>

<p>Any field with a schema giving a default value will only appear should a
value for that field be <em>omitted</em> in the input data. If the data
provides, for example, an explicit <code>nil</code> value then a
corresponding explicit <code>nil</code> will be rendered, regardless of
defaults.</p>

<p>For belt-and-braces, unless subsequent profiling shows performance issues,
callers should call validate first to self-check their internal data
against the schema prior to rendering. That way, coding errors will be
discovered immediately, rather than hidden / obscured by the rendered
sanitisation.</p>

<p>Since rendering top-level <code>nil</code> is not valid JSON, should
<code>nil</code> be provided as input, it&#39;ll be treated as an empty
hash (“+{}+”) instead.</p>
          
          

          
          <div class="method-source-code" id="render-source">
            <pre><span class="ruby-comment"># File lib/api_tools/presenters/base_presenter.rb, line 55</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">data</span>)
  <span class="ruby-identifier">target</span> = {}
  <span class="ruby-identifier">data</span>   = <span class="ruby-identifier">data</span> <span class="ruby-operator">||</span> {}
  <span class="ruby-ivar">@schema</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">target</span>)
  <span class="ruby-identifier">target</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-schema" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">schema</span><span
            class="method-args">(&block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Define the JSON schema for validation.</p>
<dl class="rdoc-list note-list"><dt>&amp;block
<dd>
<p>Block that makes calls to the DSL defined in <a
href="BaseDSL.html">ApiTools::Presenters::BaseDSL</a> in order to define
the schema.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="schema-source">
            <pre><span class="ruby-comment"># File lib/api_tools/presenters/base_presenter.rb, line 16</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">schema</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@schema</span> = <span class="ruby-constant">ApiTools</span><span class="ruby-operator">::</span><span class="ruby-constant">Presenters</span><span class="ruby-operator">::</span><span class="ruby-constant">Object</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@schema</span>.<span class="ruby-identifier">instance_eval</span> <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-validate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validate</span><span
            class="method-args">(data)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Given JSON data that&#39;s been parsed from a <a
href="String.html">String</a> into an equivalent Ruby <a
href="Hash.html">Hash</a>, with <a href="String.html">String</a> keys,
validate that data against the schema and return an <a
href="../Errors.html">ApiTools::Errors</a> instance. This will contain
*zero or more* errors; if zero, there is no problem, else validation
failures are described.</p>
<dl class="rdoc-list note-list"><dt><code>data</code>
<dd>
<p>Ruby <a href="Hash.html">Hash</a> representation of JSON data that is to be
validated against &#39;this&#39; schema. Keys must be Strings, not Symbols.</p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="validate-source">
            <pre><span class="ruby-comment"># File lib/api_tools/presenters/base_presenter.rb, line 30</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-identifier">data</span>)
  <span class="ruby-ivar">@schema</span>.<span class="ruby-identifier">validate</span>(<span class="ruby-identifier">data</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

